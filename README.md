# NDC007 BookPicker

このリポジトリは、Go 言語の学習を目的としたサンプルアプリケーションです。PostgreSQL を利用したデータベースを中心に、HTTP API、gRPC サービス、バッチ処理ジョブの 3 つのコンポーネントでランダムな書籍情報を提供します。

## ディレクトリ構成

```
cmd/             実行可能ファイルのエントリポイント
    api/         HTTP API サーバー
    batch/       書籍データを取り込むバッチジョブ
    grpc/        gRPC サーバー
internal/        アプリケーション共通パッケージ
    cinii/       CiNii Books API クライアント
    database/    DB セットアップとスキーマ
    env/         環境変数の読み込み
    googlebooks/ Google Books API クライアント
    grpcserver/  gRPC サービス実装
    model/       ドメインモデル
    server/      HTTP ハンドラーと OpenAPI
api/v1/          protobuf 定義と生成物
```

## 実装概要

- **HTTP API**
  - 環境変数を読み込んでデータベースへ接続し、HTTP サーバーを起動します。
  - `/api/v1/books/random` エンドポイントでは、保存済みの書籍情報から指定件数をランダムに返します。
  - OpenAPI 定義を組み込み、ドキュメント閲覧用の UI を提供します。

- **バッチ処理**
  - CiNii から情報科学分野の各カテゴリごとに ISBN をランダムに取得します。
  - 取得した ISBN を基に Google Books から書籍の詳細情報を取得し、データベースへ一括登録します。
  - ISBN 取得と詳細情報取得を並列で実行し、完了後にトランザクションをコミットします。

- **gRPC サービス**
  - BookService を公開する gRPC サーバーを起動し、ランダムな書籍情報を返します。

- **その他のモジュール**
  - データベース接続設定やスキーマの埋め込み、環境変数の検証、HTTP と gRPC のテストなどを提供します。

このように、各コンポーネントが役割ごとに分割されており、Go の標準ライブラリと外部ライブラリを組み合わせたシンプルな書籍検索サービスとなっています。
